datasource db {
  provider = "mysql"
}

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

enum Role {
  ADMIN
  TEACHER
  STUDENT
}

// Hier kan je nieuwe databaseschema's toevoegen. run "npx prisma generate" om de changes door te voeren.

model User {
  id             String @id @default(uuid())
  name           String
  email          String @unique
  hashedPassword String
  role           Role   @default(STUDENT)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  userFavorites UserFavorites[]
}

model UserFavorites {
  id             String @id @default(uuid())
  userId         String
  user           User   @relation(fields: [userId], references: [id])
  choiceModuleId String
  choiceModule   ChoiceModule @relation(fields: [choiceModuleId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([userId, choiceModuleId])
}

model ChoiceModule {
  id               String                 @id @default(uuid())
  name             String
  shortDescription String?
  description      String?                @db.Text
  content          String?                @db.Text
  studyCredits     Int
  //contactId     Int
  level            String
  learningOutcomes String?                @db.Text
  //interestsMatchScore Float
  //popularityScore       Int
  //estimatedDifficulty  Int
  availableSpots   Int
  startDate        String
  location         ChoiceModuleLocation[]
  moduleTags       ChoiceModuleTags[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  userFavorites UserFavorites[]
}

model Location {
  id            String                 @id @default(uuid())
  name          String                 @unique
  choiceModules ChoiceModuleLocation[]
}

model ChoiceModuleLocation {
  ChoiceModule   ChoiceModule @relation(fields: [choiceModuleId], references: [id])
  choiceModuleId String
  Location       Location     @relation(fields: [locationId], references: [id])
  locationId     String

  @@id([choiceModuleId, locationId])
}

model ModuleTags {
  id            String             @id @default(uuid())
  name          String             @unique
  choiceModules ChoiceModuleTags[]
}

model ChoiceModuleTags {
  ChoiceModule   ChoiceModule @relation(fields: [choiceModuleId], references: [id])
  choiceModuleId String
  ModuleTags     ModuleTags   @relation(fields: [moduleTagsId], references: [id])
  moduleTagsId   String

  @@id([choiceModuleId, moduleTagsId])
}
